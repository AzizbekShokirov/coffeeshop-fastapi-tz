#!/bin/bash

# Start FastAPI Application in Production Mode

set -o errexit
set -o nounset

echo "ðŸš€ Starting FastAPI Production Server..."
echo "âš¡ Running with multiple workers"

# Run migrations before starting the server
echo "ðŸ“¦ Running database migrations..."
alembic upgrade head

echo "âœ… Migrations completed"
echo "ðŸ”— Starting API server..."

exec uvicorn app.main:app \
    --host 0.0.0.0 \
    --port 8000 \
    --workers 4 \
    --no-access-log \
    --proxy-headers \
    --forwarded-allow-ips='*'
